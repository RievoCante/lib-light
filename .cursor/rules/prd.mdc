---
description: it is helpful when you want to know the overview of the project
alwaysApply: false
---

### 1. Overview & Tech Stack

- **Product:** Mobile stock trading app for the Thai market
- **Framework:** Flutter (iOS & Android)
- **State Management:** Riverpod
- **Navigation:** `go_router`
- **Backend:** Firebase (Auth, Firestore)
- **Local Storage:** `shared_preferences` (app preferences), `flutter_secure_storage` (optional)
- **Design:** Light/Dark theme support. Portrait mode only
- **Localization:** English (default) and Thai. String files in `lib/localization/en.json` and `lib/localization/th.json`

### 2. Core Features

- **Authentication:**

  - Email/Password login and signup
  - Google Sign-In (Gmail)
  - Phone authentication (SMS verification)
  - "Remember Me" option
  - Password reset

- **Main Navigation (BottomNavBar):**

  - **Home:** SET index, calendar with dividend events, corporate actions
  - **Buy Sell:** Thai/US Stock, Mutual Fund tabs. Order entry (Volume, Price, PIN). Order book display
  - **Portfolio:** Portfolio/Order/Summary tabs. Holdings list (Symbol, In Port, Avg, Market, %U.P.L)
  - **Content:** Popular/Breaking/Research tabs. News articles
  - **You:** Settings (Language, Theme, Sign Out), Contact Us (support chat), Privacy & Policy

- **Support Chat:**
  - Real-time messaging via Firestore
  - FAQ questions (sends question as message)
  - Recent Orders button
  - Auto-scroll on new messages

### 3. Authentication & User Model

- **Firebase Authentication:** Email, Google, Phone
- **User Model:** `uid`, `email`, `displayName`, `photoUrl`, `phoneNumber`, `accountNumber` (from Firestore), `authProvider`, `rememberMe`
- **User Profile:** Stored in Firestore `users/{uid}` collection
- **Chat ID:** Uses `userId` (Firebase UID) as chat document ID

### 4. Project Structure

```
lib/
├── main.dart
├── app.dart
│
├── core/
│   ├── constants/          // Colors, text styles, dimensions
│   ├── theme/              // Light/dark themes
│   ├── utils/              // Formatters, validators
│   └── exceptions/         // Custom exceptions (auth_exceptions.dart)
│
├── data/
│   ├── models/             // User, Stock, Portfolio, SupportMessage, etc.
│   ├── repositories/       // FirebaseAuthRepository, FirestoreUserRepository, FirestoreChatRepository, MockDataRepository
│   └── services/           // StorageService (app preferences only)
│
├── presentation/
│   ├── screens/
│   │   ├── login/          // LoginPage (Email/Gmail/Phone tabs)
│   │   ├── home/
│   │   ├── buy_sell/
│   │   ├── portfolio/
│   │   ├── content/
│   │   ├── settings/
│   │   └── support/        // SupportChatPage
│   ├── widgets/
│   │   ├── common/         // Shared components
│   │   ├── navigation/     // BottomNavBar
│   │   └── chat/           // MessageBubble, FaqItemWidget
│   └── providers/          // Auth, Settings, Chat, Stock, Portfolio, etc.
│
└── localization/
    ├── app_localizations.dart
    ├── en.json
    └── th.json
```

### 5. Key Packages

```yaml
# State Management
flutter_riverpod: ^2.4.0

# Navigation
go_router: ^12.0.0

# Firebase
firebase_core: ^4.2.0
firebase_auth: ^6.1.1
cloud_firestore: ^6.0.3
google_sign_in: ^6.2.1

# Local Storage
shared_preferences: ^2.2.0
flutter_secure_storage: ^9.0.0

# UI Components
table_calendar: ^3.0.9
flutter_svg: ^2.0.0
flutter_markdown: ^0.6.18

# WebView & Media
webview_flutter: ^4.4.2
webview_flutter_android: ^3.0.0
image_picker: ^1.0.0

# Localization
intl: ^0.20.2
```

### 6. Firebase Structure

- **Collections:**

  - `users/{uid}` - User profiles (accountNumber, email, displayName, etc.)
  - `chats/{chatId}` - Chat documents (chatId = userId)
  - `chats/{chatId}/messages/{messageId}` - Chat messages

- **Security Rules:**
  - Users can only access their own profile (`users/{userId}`)
  - Users can only access their own chat (`chats/{chatId}` where chatId = userId)
  - Messages are accessible only by chat owner

### 7. Design System

- **Fonts:** San Francisco (iOS) / Roboto (Android)
- **Colors:**
  - Primary Blue: #3B82F6
  - Red (loss): #EF4444
  - Green (gain): #10B981
  - Yellow/Gold: #F59E0B
  - Orange (events): #F97316
